<!--
  Build the UI FindBugs Eclipse plugin.
  The Core FindBugs Eclipse plugin should be built *before* building this plugin.
-->
<project name="eclipseUIPlugin" default="build">

	<!-- Get top level build properties. -->
	<property file="../../../build.properties"/>

	<!-- Build properties, automatically generated by edu.umd.cs.findbugs.EclipseClasspath -->
	<property file="build.properties"/>

	<property name="build.dir" value="build"/>
	<property name="class.dir" value="${build.dir}/classes"/>
	<property name="src.dir" value="src"/>
	<property name="plugin.dir.name" value="${plugin.id}_${plugin.version}"/>
	<property name="plugin.zip" value="${plugin.dir.name}.zip"/>
	<property name="plugin.files" value="findbugs-plugin.jar,icons/*.gif,plugin.xml,plugin.properties"/>

	<target name="init">
		<mkdir dir="${build.dir}"/>
		<mkdir dir="${class.dir}"/>
	</target>

	<target name="build" depends="init">
		<javac source="1.5" srcdir="${src.dir}" destdir="${class.dir}"
			target="1.4"
			debug="true"
			compiler="com.cortexeb.Jsr14CompilerAdapter">
			<classpath path="${plugin.build.classpath}"/>
		</javac>

		<jar destfile="findbugs-plugin.jar">
			<fileset dir="${class.dir}" includes="**/*.class"/>
		</jar>

		<zip destfile="${plugin.zip}">
			<zipfileset dir="." includes="${plugin.files}" prefix="${plugin.dir.name}"/>
		</zip>
	</target>

	<target name="clean">
		<delete dir="${build.dir}"/>
		<delete file="findbugs-plugin.jar"/>
		<delete file="${plugin.zip}"/>
	</target>

</project>
