<!--
  Build the "core" FindBugs Eclipse plugin containing the
  main engine, detector plugin, and required libraries.
-->
<project name="findbugsCorePlugin" default="build">

	<!-- Build properties, automatically generated by edu.umd.cs.findbugs.EclipseClasspath -->
	<property file="build.properties"/>

	<property name="build.dir" value="build"/>
	<property name="core.lib.dir" value="../../../lib"/>
	<property name="core.libs" value="bcel.jar,dom4j-full.jar,findbugs.jar"/>
	<property name="plugin.lib.dir" value="../../../plugin"/>
	<property name="plugin.zip" value="${plugin.id}_${plugin.version}.zip"/>

	<!-- Ensure build directories exist. -->
	<target name="init">
		<mkdir dir="${build.dir}"/>
		<mkdir dir="${build.dir}/plugin"/>
	</target>

	<!-- Copy jar files exported by the plugin. -->
	<target name="copyfiles" depends="init">
		<copy todir="${build.dir}">
			<fileset dir="${core.lib.dir}" includes="${core.libs}"/>
			<fileset dir="." includes="plugin.xml" />
		</copy>
		<copy todir="${build.dir}/plugin">
			<fileset dir="${plugin.lib.dir}" includes="*.jar"/>
		</copy>
	</target>

	<!-- Build the plugin .zip file. -->
	<target name="build" depends="copyfiles">
		<zip destfile="${plugin.zip}">
			<zipfileset dir="${build.dir}" includes="**"/>
		</zip>
	</target>

	<!-- Remove generated files and directories. -->
	<target name="clean">
		<delete dir="${build.dir}"/>
		<delete file="${plugin.zip}"/>
	</target>

</project>
