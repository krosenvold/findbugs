<project name="webCloudClient" default="install">

  <property file="local.properties" />


    <property name="src.dir" value="src/java"/>
    <property name="gsrc.dir" value="generated-src"/>
    <property name="classes.dir" value="build/classes"/>
    <property name="lib.dir" value="lib"/>
    <property name="findbugs.home" value="../findbugs"/>
    <property name="protocol.home" value="../webCloudProtocol"/>

        <path id="client.classpath">
		<fileset dir="${lib.dir}">
			<include name="**/*.jar"/>
		      </fileset>
		<fileset dir="${findbugs.home}/lib">
			<include name="*.jar"/>
		      </fileset>
		<fileset dir="${protocol.home}/lib">
			<include name="*.jar"/>
		      </fileset>
		<pathelement location="${protocol.home}/build"/>

        </path>


    <target name="validate">
        <xmlvalidate lenient="false" failonerror="yes">
            <attribute name="http://apache.org/xml/features/validation/schema" value="true"/>
            <attribute name="http://xml.org/sax/features/namespaces" value="true"/>
            <fileset dir="etc" includes="*.xml"/>
        </xmlvalidate>
    </target>

   <target name="classes">
	<mkdir dir="${classes.dir}"/>
        <javac
		destdir="${classes.dir}"
		source="1.5"
		target="1.5"
		includeantruntime="false"
		encoding="ISO-8859-1"
		deprecation="off"
		debug="on">
	<src path="${src.dir}"/>
	<src path="${gsrc.dir}"/>
 	<classpath refid="client.classpath"/>
	</javac>
	</target>
                                        

      

    <target name="plugin" depends="classes">
        <jar destfile="build/webCloudClient.jar"
             manifest="etc/MANIFEST.MF">
            <fileset dir="etc">
                <include name="*.xml"/>
            </fileset>
            <fileset dir="${classes.dir}">
                <include name="**/*.class"/>
            </fileset>
            <fileset dir="../webCloudProtocol/build">
                <include name="**/*.class"/>
            </fileset>
        </jar>
    </target>
    <target name="install" depends="plugin">
        <copy todir="${findbugs.home}/plugin" flatten="true">
            <fileset dir="build">
                <include name="*.jar"/>
            </fileset>
        </copy>
        <copy todir="${findbugs.home}/jnlp" flatten="true">
            <fileset dir="etc">
                <include name="*.jnlp"/>
            </fileset>
        </copy>
        <copy todir="${findbugs.home}/plugin/webCloudClient" flatten="true">
            <fileset dir="lib">
                <include name="**/*.jar"/>
                <exclude name="mockito-all-1.8.2.jar"/>
            </fileset>
            <fileset dir="../webCloudProtocol/lib">
                <include name="**/*.jar"/>
            </fileset>
        </copy>
    </target>

</project>

      
